# System Architecture - ML Fire Detection with N8N Integration

## High-Level Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Physical Infrastructure                          â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ Camera 1 â”‚  â”‚ Camera 2 â”‚  â”‚ Camera 3 â”‚  â”‚ Camera N â”‚               â”‚
â”‚  â”‚ Floor 1  â”‚  â”‚ Floor 2  â”‚  â”‚ Floor 3  â”‚  â”‚ Floor N  â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜               â”‚
â”‚        â”‚             â”‚             â”‚             â”‚                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚             â”‚             â”‚             â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Live Camera Detection Server                          â”‚
â”‚                   (live_camera_detection_server.py)                      â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Camera Stream Processing (15 FPS fire detection)                 â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚  Every Frame:     Capture â†’ Resize â†’ Stream to Dashboard          â”‚  â”‚
â”‚  â”‚  Every 2 Frames:  Face Detection â†’ Person Tracking                â”‚  â”‚
â”‚  â”‚  Every 4 Frames:  Fire Detection â†’ ML Inference                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ML Fire Detector (services/ml_fire_detector.py)                  â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                 â”‚  â”‚
â”‚  â”‚  â”‚  YOLOv8 Modelâ”‚ â”€â”€> Fire/Smoke Detection                        â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                                 â”‚  â”‚
â”‚  â”‚         â”‚ (if unavailable)                                        â”‚  â”‚
â”‚  â”‚         â–¼                                                          â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                 â”‚  â”‚
â”‚  â”‚  â”‚ Color-Based  â”‚ â”€â”€> HSV Fire Detection (Fallback)              â”‚  â”‚
â”‚  â”‚  â”‚  Detection   â”‚                                                 â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                     â”‚
                    â–¼                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Alert Manager              â”‚   â”‚   Backend API                â”‚
â”‚ (services/alert_manager.py)  â”‚   â”‚   (Laravel)                  â”‚
â”‚                              â”‚   â”‚                              â”‚
â”‚  When Fire Detected:         â”‚   â”‚  Endpoints:                  â”‚
â”‚  1. Get floor occupancy      â”‚â—„â”€â”€â”¤  â€¢ /presence/floor-live/{id}â”‚
â”‚  2. Save screenshot          â”‚   â”‚  â€¢ /alerts/fire             â”‚
â”‚  3. Send N8N alert           â”‚   â”‚  â€¢ /employees/*             â”‚
â”‚  4. Log to backend           â”‚â”€â”€â–ºâ”‚                              â”‚
â”‚                              â”‚   â”‚  Features:                   â”‚
â”‚  If people present:          â”‚   â”‚  â€¢ Presence tracking         â”‚
â”‚  â†’ CRITICAL_EVACUATION       â”‚   â”‚  â€¢ Alert history            â”‚
â”‚                              â”‚   â”‚  â€¢ Dashboard updates        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         N8N Workflow Engine                              â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                       â”‚
â”‚  â”‚   Webhook    â”‚ â—„â”€â”€â”€ Receives fire alerts                            â”‚
â”‚  â”‚   Trigger    â”‚                                                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                                       â”‚
â”‚         â”‚                                                                â”‚
â”‚         â–¼                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                       â”‚
â”‚  â”‚    Switch    â”‚ â”€â”€â”¬â”€ FIRE_EMERGENCY                                  â”‚
â”‚  â”‚  Alert Type  â”‚   â”œâ”€ CRITICAL_EVACUATION                             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€ PRESENCE_UPDATE                                 â”‚
â”‚         â”‚                                                                â”‚
â”‚    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚
â”‚    â–¼         â–¼           â–¼            â–¼                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚ â”‚WhatsAppâ”‚Voice â”‚ â”‚  SMS     â”‚ â”‚ Backend  â”‚                           â”‚
â”‚ â”‚Messageâ”‚ Call  â”‚ â”‚ Alert    â”‚ â”‚ Logging  â”‚                           â”‚
â”‚ â””â”€â”€â”€â”¬â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚     â”‚       â”‚         â”‚            â”‚                                    â”‚
â””â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚       â”‚         â”‚            â”‚
      â–¼       â–¼         â–¼            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      External Services (Twilio)                          â”‚
â”‚                                                                          â”‚
â”‚  ğŸ“± WhatsApp    ğŸ“ Voice Call    ğŸ’¬ SMS    â˜ï¸ Cloud Storage            â”‚
â”‚                                                                          â”‚
â”‚  Recipients:                                                             â”‚
â”‚  â€¢ Security Team                                                         â”‚
â”‚  â€¢ Building Manager                                                      â”‚
â”‚  â€¢ Emergency Services (critical alerts only)                             â”‚
â”‚  â€¢ Floor Occupants (future feature)                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Data Flow Diagram

### 1. Fire Detection Flow

```
Camera Frame
    â”‚
    â”œâ”€â–º ML Fire Detector
    â”‚   â”œâ”€â–º YOLOv8 Model (.pt file)
    â”‚   â”‚   â””â”€â–º Fire/Smoke Detection (0-1 confidence)
    â”‚   â”‚
    â”‚   â””â”€â–º Color-Based Fallback (if ML unavailable)
    â”‚       â””â”€â–º HSV Analysis â†’ Orange/Yellow/Red detection
    â”‚
    â””â”€â–º Detection Result
        {
          detected: true/false,
          type: 'fire' | 'smoke',
          confidence: 0.85,
          bbox: [x1, y1, x2, y2],
          severity: 'warning' | 'critical',
          method: 'ml' | 'color'
        }
```

### 2. Alert Distribution Flow

```
Fire Detected
    â”‚
    â”œâ”€â–º Get Floor Occupancy
    â”‚   â””â”€â–º Laravel API: /presence/floor-live/{floor_id}
    â”‚       â””â”€â–º Returns: { people_count: 5, people_details: [...] }
    â”‚
    â”œâ”€â–º Save Screenshot
    â”‚   â””â”€â–º backend-laravel/public/storage/alerts/fire_cam1_floor2_20260121.jpg
    â”‚
    â”œâ”€â–º Alert Manager
    â”‚   â”‚
    â”‚   â”œâ”€â–º N8N Webhook
    â”‚   â”‚   {
    â”‚   â”‚     alert_type: "FIRE_EMERGENCY",
    â”‚   â”‚     floor_id: 2,
    â”‚   â”‚     people_count: 5,
    â”‚   â”‚     confidence: 0.85,
    â”‚   â”‚     message: "ğŸ”¥ FIRE ALERT - Floor 2 (5 people present)"
    â”‚   â”‚   }
    â”‚   â”‚
    â”‚   â””â”€â–º Laravel Backend
    â”‚       POST /api/v1/alerts/fire
    â”‚       â””â”€â–º Stores in database
    â”‚           â””â”€â–º Broadcasts to dashboard via WebSocket
    â”‚
    â””â”€â–º N8N Processing
        â”‚
        â”œâ”€â–º Switch on alert_type
        â”‚   â”‚
        â”‚   â”œâ”€â–º FIRE_EMERGENCY
        â”‚   â”‚   â””â”€â–º WhatsApp Message
        â”‚   â”‚
        â”‚   â”œâ”€â–º CRITICAL_EVACUATION (if people_count > 0)
        â”‚   â”‚   â”œâ”€â–º WhatsApp Message
        â”‚   â”‚   â”œâ”€â–º Voice Call
        â”‚   â”‚   â””â”€â–º SMS Alert
        â”‚   â”‚
        â”‚   â””â”€â–º PRESENCE_UPDATE
        â”‚       â””â”€â–º WhatsApp Summary (low priority)
        â”‚
        â””â”€â–º Delivery Confirmation
            â””â”€â–º Log to backend
```

### 3. WhatsApp Message Flow

```
Alert Manager
    â”‚
    â”œâ”€â–º Compose Message
    â”‚   ğŸ”¥ FIRE ALERT - Floor 2
    â”‚   Location: Conference Room
    â”‚   Camera: Main Camera
    â”‚   Type: FIRE
    â”‚   Severity: CRITICAL
    â”‚   Confidence: 85.0%
    â”‚   ğŸ‘¥ People on floor: 5
    â”‚   â° Time: 2026-01-21 14:30:25
    â”‚   
    â”‚   âš ï¸ EVACUATION REQUIRED - 5 people present!
    â”‚
    â”œâ”€â–º Send to N8N Webhook
    â”‚
    â””â”€â–º N8N Workflow
        â”‚
        â”œâ”€â–º Twilio WhatsApp Node
        â”‚   From: whatsapp:+14155238886
        â”‚   To: whatsapp:+1234567890
        â”‚   Message: [composed message]
        â”‚
        â””â”€â–º Delivery
            â””â”€â–º Security team receives WhatsApp notification
```

## Component Integration

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Service Layer                                             â”‚
â”‚                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ml_fire_detector.py â”‚  â”‚  alert_manager.py        â”‚   â”‚
â”‚  â”‚                     â”‚  â”‚                          â”‚   â”‚
â”‚  â”‚ â€¢ YOLOv8 inference  â”‚  â”‚ â€¢ N8N webhook sender     â”‚   â”‚
â”‚  â”‚ â€¢ Color fallback    â”‚  â”‚ â€¢ Floor occupancy fetch  â”‚   â”‚
â”‚  â”‚ â€¢ Confidence calc   â”‚  â”‚ â€¢ Critical alerts        â”‚   â”‚
â”‚  â”‚ â€¢ Bbox annotation   â”‚  â”‚ â€¢ Backend logging        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Fire Detection    â”‚  â”‚ Live Camera        â”‚
â”‚ Service (FastAPI) â”‚  â”‚ Server (Flask)     â”‚
â”‚                   â”‚  â”‚                    â”‚
â”‚ Port: 8002        â”‚  â”‚ Port: 5000         â”‚
â”‚ /detect-fire-ml   â”‚  â”‚ /video_feed        â”‚
â”‚ /health           â”‚  â”‚ /api/cameras       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Laravel Backend     â”‚
        â”‚ Port: 8000          â”‚
        â”‚                     â”‚
        â”‚ â€¢ Presence tracking â”‚
        â”‚ â€¢ Alert storage     â”‚
        â”‚ â€¢ Dashboard API     â”‚
        â”‚ â€¢ WebSocket events  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Technology Stack

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Computer Vision & ML                                   â”‚
â”‚ â€¢ OpenCV 4.8+          - Image processing              â”‚
â”‚ â€¢ YOLOv8 (Ultralytics) - Fire/smoke detection         â”‚
â”‚ â€¢ NumPy               - Array operations               â”‚
â”‚ â€¢ InsightFace         - Face recognition              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Backend Services                                       â”‚
â”‚ â€¢ FastAPI             - Fire detection API             â”‚
â”‚ â€¢ Flask               - Camera streaming server        â”‚
â”‚ â€¢ Laravel (PHP)       - Main backend & dashboard       â”‚
â”‚ â€¢ PostgreSQL/MySQL    - Database                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Integration & Automation                               â”‚
â”‚ â€¢ N8N                 - Workflow automation            â”‚
â”‚ â€¢ Twilio              - WhatsApp/Voice/SMS            â”‚
â”‚ â€¢ WebSockets          - Real-time dashboard updates    â”‚
â”‚ â€¢ python-dotenv       - Environment configuration      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Security & Performance

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Performance Optimizations                              â”‚
â”‚                                                        â”‚
â”‚ â€¢ Frame skip (every 4th frame for fire = 15 FPS)      â”‚
â”‚ â€¢ Low resolution (480x360 for speed)                  â”‚
â”‚ â€¢ JPEG compression (75% quality for streaming)        â”‚
â”‚ â€¢ Memory cleanup (GC every 200 frames)                â”‚
â”‚ â€¢ Alert cooldown (30s between alerts)                 â”‚
â”‚ â€¢ Non-blocking detection (threaded)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Security Features                                      â”‚
â”‚                                                        â”‚
â”‚ â€¢ CORS protection                                      â”‚
â”‚ â€¢ API authentication (Laravel Sanctum)                â”‚
â”‚ â€¢ Webhook signature verification (N8N)                â”‚
â”‚ â€¢ Rate limiting on alerts                              â”‚
â”‚ â€¢ Screenshot access control                            â”‚
â”‚ â€¢ Environment variable secrets                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Deployment Architecture

```
Production Environment:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Physical Cameras   â”‚   â”‚  Physical Cameras   â”‚
â”‚  Building A         â”‚   â”‚  Building B         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                         â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  Edge Server   â”‚
            â”‚  (Local)       â”‚
            â”‚                â”‚
            â”‚ â€¢ Camera feeds â”‚
            â”‚ â€¢ ML inference â”‚
            â”‚ â€¢ Fast alerts  â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  Cloud Backend â”‚
            â”‚  (AWS/Azure)   â”‚
            â”‚                â”‚
            â”‚ â€¢ Laravel API  â”‚
            â”‚ â€¢ Database     â”‚
            â”‚ â€¢ Dashboard    â”‚
            â”‚ â€¢ N8N          â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                       â”‚
        â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Twilio     â”‚      â”‚  Dashboard   â”‚
â”‚   (WhatsApp/ â”‚      â”‚  (Web/Mobile)â”‚
â”‚    Voice)    â”‚      â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**This architecture provides:**
- ğŸ”¥ Real-time fire detection (15 FPS)
- ğŸ¤– ML-powered accuracy
- ğŸ“± Instant WhatsApp/Voice alerts
- ğŸ‘¥ People tracking and evacuation alerts
- ğŸ¯ Low latency (< 2 seconds from detection to alert)
- ğŸ”„ Automatic failover (ML â†’ Color fallback)
- ğŸ“Š Full dashboard integration
